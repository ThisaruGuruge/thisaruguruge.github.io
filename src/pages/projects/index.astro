---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import ProjectCard from '../../components/ProjectCard.astro';
import Button from '../../components/Button.astro';
import BreadcrumbSchema from '../../components/schemas/BreadcrumbSchema.astro';
import { SECTIONS } from '../../constants/site';
import { getAllProjects } from '../../utils/collections';

const projects = await getAllProjects();

const site = 'https://thisaru.me';
const canonicalURL = new URL(Astro.url.pathname, site);

// Create breadcrumb items
const breadcrumbItems = [
  { name: 'Home', url: site },
  { name: 'Projects', url: canonicalURL.toString() }
];
---

<Layout title={SECTIONS.PROJECTS.TITLE} description={SECTIONS.PROJECTS.DESCRIPTION}>
  <BreadcrumbSchema items={breadcrumbItems} slot="head" />

  <Header />
  <main id="main-content" role="main" aria-label="Projects page">
    <section class="py-20 section-fade-in" aria-labelledby="projects-heading">
      <div class="container">
        <h1 id="projects-heading" class="heading-1 text-center mb-4 text-text">Projects</h1>
        <p class="text-center text-text-muted mb-8 text-lg max-w-2xl mx-auto">
          A collection of projects I've worked on, from GraphQL tools to experimental libraries.
        </p>
        
        <div class="text-center mb-12">
          <Button 
            variant="ghost" 
            size="lg" 
            href="https://github.com/ThisaruGuruge" 
            target="_blank" 
            rel="noopener noreferrer"
            icon="github" 
            iconPosition="left"
            class="bg-background-card border-2 border-text/20 rounded-xl hover:border-accent-cyan hover:text-accent-cyan hover:shadow-lg"
          >
            View All on GitHub
          </Button>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {projects.map((project, index) => (
            <div class="scroll-fade-in-up" style={`animation-delay: ${index * 0.1}s;`}>
              <ProjectCard {...project.data} />
            </div>
          ))}
        </div>
      </div>
    </section>
  </main>
  <Footer />
</Layout>
